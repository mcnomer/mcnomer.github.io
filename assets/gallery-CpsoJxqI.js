(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=i(r);fetch(r.href,c)}})();function v(t="",n,i){const o=document.createElement(t);return n&&(o.className=n),i&&(o.innerHTML=i),o}function D(t,n){const i="<span>i</span>";let o;t.onclick=function r(){t.onclick=null,o&&clearTimeout(o),o=null,!(n&&n())&&(t.setAttribute("open",""),t.onclick=null,document.body.onclick=document.body.oncontextmenu=function(a){t.contains(a.target)||(t.onclick=r,document.body.onclick=document.body.oncontextmenu=null,t.removeAttribute("open"),o=setTimeout(()=>{t.innerHTML=i},300))})}}const h=document.querySelector(".imageviewer .pagination");function O(t,n){for(;h.firstChild;)h.firstChild.remove();if(!(t.pages.length<=1))for(let i=0;i<t.pages.length;i++){const o=v("button");o.onclick=()=>{const r=h.children;let c;for(let a=0;a<r.length;a++)r[a].hasAttribute("selected")&&(c=a),r[a].removeAttribute("selected");n(t,c-i),o.setAttribute("selected","")},h.append(o)}}function W(t,n){if(t.pages.length<=1)return;const i=h.children;for(const o of i)o.removeAttribute("selected");i[n].setAttribute("selected","")}function V(t,n,i,o){let r={};function c(l){l.preventDefault(),requestAnimationFrame(()=>{let s=l.isPrimary?"primary":l.pointerId;if(!r[s]||!r[s].down)return;const[m,d]=[l.clientX,l.clientY];r[s].pos=[m,d],r[s].diff=[m-r[s].startX,d-r[s].startY],i(r)})}function a(l){l.preventDefault(),requestAnimationFrame(()=>{let s=l.isPrimary?"primary":l.pointerId;const[m,d]=[l.clientX,l.clientY];r[s].pos=[m,d],r[s].diff=[m-r[s].startX,d-r[s].startY],r[s].down=!1,o(r)}),l.isPrimary&&(document.removeEventListener("pointermove",c,!0),document.removeEventListener("pointerup",a,!0),document.removeEventListener("pointercancel",a,!0))}function u(l){l.preventDefault(),requestAnimationFrame(()=>{let s=l.isPrimary?"primary":l.pointerId;r[s]||(r[s]={}),r[s].pos=[r[s].startX,r[s].startY]=[l.clientX,l.clientY],r[s].diff=[0,0],r[s].down=!0,n(r)}),l.isPrimary&&(document.addEventListener("pointermove",c,!0),document.addEventListener("pointerup",a,!0),document.addEventListener("pointercancel",a,!0))}t.onpointerdown=u}function F(){e.zoomedIn=!e.zoomedIn,e.image.style.transition="",e.currentScale=e.zoomedIn?1.5:1,e.centreX=e.centreY=0;const t=`scale(${e.currentScale})`;return e.image.style.transform=t,e.zoomedIn}let w,y,M,b=1;function N(t){window.imageViewer=e,b=e.currentScale,y=[e.centreX,e.centreY];const n=[];for(const o of t)n.push(o.pos);const i=S(...n);w=[i[0],i[1]],M=z(n,i),e.image.style.transition="initial",e.zoomedIn=!0}function G(t){let n=[];for(const $ of t)n.push($.pos);const i=S(...n),o=z(n,i);e.currentScale=Math.min(b*(o/M),8);const r=[window.innerWidth/2+y[0],window.innerHeight/2+y[1]],c=(e.currentScale-b)/b,a=-((w[0]-r[0])*c),u=-((w[1]-r[1])*c),l=[i[0]-w[0],i[1]-w[1]],s=l[0]+y[0]+a,m=l[1]+y[1]+u;[e.centreX,e.centreY]=[s,m];const d=`translate(${s}px, ${m}px)`,H=`scale(${e.currentScale})`;e.image.style.transform=d+" "+H}function Z(t){e.currentScale<=1?(e.zoomedIn=!1,e.currentScale=1,e.image.style.transition="",e.image.style.transform="",M=0,y=[e.centreX,e.centreY]=[0,0]):e.zoomedIn=!0;let n=[];for(const i of t)n.push(i.pos)}let P=0,A=0;function B(){P=e.centreX,A=e.centreY}function j(t){let[n,i]=t.diff;const o=window.innerWidth*e.currentScale/2,r=window.innerHeight*e.currentScale/2;n=Math.max(Math.min(P+n,o),-o),i=Math.max(Math.min(A+i,r),-r),[e.centreX,e.centreY]=[n,i];const c=`translate(${n}px, ${i}px)`,a=`scale(${e.currentScale})`;e.image.style.transform=c+" "+a}function K(){[P,A]=[e.centreX,e.centreY]}function z(t,n){const i=n||S(...t);let o=[];for(const r of t){const c=Math.hypot(r[0]-i[0],r[1]-i[1]);o.push(c)}return S(...o)}function S(...t){if(typeof t[0]=="number"){let n=0;for(const i of t)n+=i;return n/t.length}else if(Array.isArray(t[0])){let n=[];for(const i of t)for(let o=0;o<i.length;o++)o>=n.length?n.push(i[o]):n[o]+=i[o];for(let i=0;i<n.length;i++)n[i]/=t.length;return n}}function R(t){t.preventDefault();const n=t.deltaY*-.001;if(e.currentScale=Math.max(Math.min(e.currentScale+n,4),1),e.currentScale<=1)e.zoomedIn=!1,e.image.style="",[e.centreX,e.centreY]=[0,0];else if(e.currentScale<4||e.currentScale===4&&n<0){e.zoomedIn=!0;const i=window.innerWidth/2+e.centreX,o=window.innerHeight/2+e.centreY,[r,c]=[t.clientX-i,t.clientY-o],a=n/(e.currentScale-n),u=e.centreX-r*a,l=e.centreY-c*a;[e.centreX,e.centreY]=[u,l];const s=`translate(${u}px, ${l}px)`,m=`scale(${e.currentScale})`;e.image.style.transform=s+" "+m}}function U(t,n,i){let o=null,r=!1,c=null,a;V(e.image,u=>{let l=[];for(const s in u)u[s].down&&l.push(u[s]);l.length===1?(e.zoomedIn&&B(),o=null,e.image.style.transition="initial",e.showArrows&&(e.buttons.next.style.opacity=e.buttons.prev.style.opacity=0,a&&clearTimeout(a),a=setTimeout(()=>e.buttons.next.style.visibility=e.buttons.prev.style.visibility="hidden",300))):N(l)},u=>{let l=[];for(const s in u)u[s].down&&l.push(u[s]);if(l.length===1){const s=l[0];if(e.zoomedIn)j(s);else{const m=s.diff;Math.abs(m[0]-m[1])>3&&o===null&&(o=Math.abs(m[0])>Math.abs(m[1])?"X":"Y");const d=o==="Y"?m[1]:m[0];e.image.style.transform=`translate${o}(${d}px)`}}else G(l)},u=>{let l=[];for(const s in u)u[s].down&&l.push(u[s]);if(l.length<1){const s=u.primary.diff;e.zoomedIn?K():(Math.abs(s[1])>window.innerHeight/4&&o==="Y"?n(Math.sign(s[1])):Math.abs(s[0])>window.innerWidth/4&&t.pages.length>1&&o==="X"?i(t,Math.sign(s[0])):e.image.style="",e.showArrows&&(e.buttons.next.style=e.buttons.prev.style="",e.buttons.next.style.opacity=e.buttons.prev.style.opacity=0,a&&clearTimeout(a),a=setTimeout(()=>e.buttons.next.style.opacity=e.buttons.prev.style.opacity="",300))),c&&clearTimeout(c),Math.abs(s[0])<5&&Math.abs(s[1])<5&&(r?(r=!1,e.zoomedIn=F(e.image)):(r=!0,c=setTimeout(()=>{r=!1},300)))}else{Z(l);for(const s of l)s.down=!1}}),e.image.addEventListener("wheel",R,{passive:!0})}const f=document.querySelector(".imageviewer"),q=document.querySelector("title"),e={viewer:f,image:null,buttons:{close:f.querySelector(".close"),prev:f.querySelector(".prev"),next:f.querySelector(".next"),info:f.querySelector(".info")},title:f.querySelector(".img-title"),zoomedIn:!1,currentScale:1,centreX:0,centreY:0,open:!1};e.buttons.close.onclick=()=>history.go(-1);let x=0,X=0,p=0;function k(t,n,i=!0){p=0,[x,X]=[t.clientX,t.clientY],f.style="",f.style.left=x+"px",f.style.top=X+"px",e.open=!0,i&&window.history.pushState([n,0],"",n.pages[0].file),requestAnimationFrame(()=>{requestAnimationFrame(()=>{J(n),f.style.transitionProperty="width, height, left, top",f.style.left=f.style.top="",f.style.width="100%",f.style.height="100%"})})}function E(t=!0){document.body.style.overflow=f.style="",f.style.transitionProperty="width, height, left, top",f.style.left=x+"px",f.style.top=X+"px",document.onkeydown=null,e.zoomedIn=!1,e.open=!1,q.innerHTML="Gallery",t&&window.history.pushState(null,"","/gallery/")}function J(t){O(t,g),T(t,0)}function T(t,n){e.image&&e.image.remove();const i=t.pages[n],o=e.image=v("img","full-img noselect");window.history.replaceState([t,n],"",i.file),o.src=_(i),o.style.visibility="hidden",o.style.opacity=0,f.append(o),setTimeout(()=>{o.style="",f.style.transitionProperty="none",document.body.style.overflow="hidden"},300),e.currentScale=1,e.centreX=0,e.centreY=0,Q(t)}function g(t,n=0){t.pages.length<=1||(e.image.style.transition="transform 0.3s ease-out",e.image.style.transform="translateX("+100*Math.sign(n)+"vw)",setTimeout(()=>{p-=n,p>t.pages.length-1&&(p=0),p<0&&(p=t.pages.length-1),T(t,p)},300))}function Q(t){e.showArrows=!1,U(t,I,g),t.pages.length<=1?(e.buttons.next.style.display=e.buttons.prev.style.display="none",e.showArrows=!1):(e.buttons.next.style=e.buttons.prev.style="",e.buttons.prev.onclick=()=>g(t,1),e.buttons.next.onclick=()=>g(t,-1),e.showArrows=!0),e.title.innerHTML=t.name,q.innerHTML="Gallery | "+t.name;const n=t.pages[p].description;n?(e.buttons.info.style.display="",D(e.buttons.info,()=>{if(!n)return!0;e.buttons.info.innerHTML="";const o=v("p","desc",n);e.buttons.info.append(o)})):e.buttons.info.style.display="none",W(t,p);let i=!1;document.onkeydown=o=>{o.code==="ArrowLeft"&&g(t,1),o.code==="ArrowRight"&&g(t,-1),o.code==="ArrowUp"&&I(-1),(o.code==="ArrowDown"||o.code==="Escape")&&I(1),(o.code==="KeyI"||o.code==="Space")&&(i?(e.image.click(),i=!1):(e.buttons.info.click(),i=!0))}}function I(t=0){e.image.style.transition="transform 0.15s ease-out",e.image.style.transform="translateY("+100*Math.sign(t)+"vh)",setTimeout(E,100)}function _(t){return navigator.connection&&(navigator.connection.effectiveType!=="4g"||navigator.connection.saveData)&&t.thumb||t.file}window.onpopstate=t=>{t.state?e.open?T(t.state[0],t.state[1]):k({clientX:Math.floor(window.innerWidth/2),clientY:Math.floor(window.innerHeight/2)},t.state[0],!1):e.open&&E(!1)};const Y=document.querySelector(".images");let C;window.debugMode=!1;async function ee(){const t=await fetch("/gallery/data.json").then(i=>i.json()).catch(i=>console.log(`Error fetching data
`+i));let n=window.innerWidth;document.onfullscreenchange=window.onresize=()=>{window.innerWidth!==n&&(L(t),n=window.width)},L(t)}function L(t){var i,o;const n=window.innerWidth<=600?1:Math.floor((window.innerWidth-600)/350+2);if(C!==n){for(;Y.firstChild;)Y.firstChild.remove();let r=[];for(let c=0;c<n;c++){const a=v("div","column");Y.append(a),r.push(a)}for(let c=0;c<t.length;c++){const a=t[c],u=a.pages[0];let l=v("img");window.debugMode&&console.log(u),l.src=((i=u.thumb)==null?void 0:i.replace(" ","%20"))||((o=u.file)==null?void 0:o.replace(" ","%20")),l.alt=a.name,l.onclick=s=>k(s,a),r[c%n].append(l)}for(let c of r)c.style.flex=100/n+"%",c.style.maxWidth="calc("+100/n+"% - 0.5em)";C=n}}window.onload=ee;
